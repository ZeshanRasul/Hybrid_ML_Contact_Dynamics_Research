# Hybrid ML Contact Dynamics

## Motivation and Overview

This project is a proof of concept research investigation into how machine learning (ML) models can support and accelerate physics calculations in complex and computationally demanding real-time simulations.

While the ML models are not intended to replace numerical computations entirely, the models are intended to improve computational performance for simulating physics phenomena which are notoriously difficult to implement in real-time due to noise, stiffness and computational constraints.

The current achieved milestone investigates whether ML can improve the estimation of contact restitution under noisy, discretely sampled dynamics.

This project has produced an encouraging baseline from which further ML and physics systems can be simulated and evaluated. While modern analytic estimators degrade rapidly under noise and temporal uncertainty, the model created has proven ML systems can successfully exploit local temporal structure around contact events to recover physically meaningful parameters.

Building upon this foundation, the developed baseline will be extended to study hybrid ML potential for more challenging physical systems such as fluid dynamics simulations.

## Physical System and Ground Truth

The physical system of this milestone simulates 2D rigidbody collision. Specifically, multiple configurable runs are performed involving a 2D circle rigidbody under the force of gravity freefalling and colliding with an infinite plane.

Each run has a fixed coefficient of restitution $e \in (0, 1)$. The governing equations of the simulation involve physically accurate freefall equations, the impact law and realistic height decay used as ground truth values for evaluation of the ML model. These equations are as follows:

### Dynamics Equations

$g = -9.81$

$\dot{v} = g$

$\dot{y} = v$

### Impact Law

$v^+ = -ev^-$

### Height Decay

$\frac{h_k+1}{h_k} = e^2$

### Visual Plots

Figures 1-3 illustrate the ground truth dynamics of the system, including phase-space trajectory, position-time evolution and velocity-time evolution. Together, these plots confirm correct physical behaviour and highlight the discontinuous, noise-sensitive nature of impact event that motivate the use of temporal windowing and learned estimators as described throughout this document.

![Position-Time evolution plot](/hybrid_ml_contact_dynamics//docs/images/timevsposition.png)

Figure 1: Position vs Time

![Velocity-Time evolution plot](/hybrid_ml_contact_dynamics//docs/images/timevsvelocity.png)

Figure 2: Velocity vs Time

![Position-Velocity evolution plot](/hybrid_ml_contact_dynamics//docs/images/positionvsvelocity.png)

Figure 3: Phase Plot (Velocity vs Position)

## Data Generation and Trajectory Logging

Data is generated by a significant number of physics simulation runs, each one lasting for a fixed duration of discrete timesteps. Key data, particularly the full time series trajectory and contact occurences of the freefalling circle are logged and persisted. This data is then accessed to generate training data for the ML model.

A strong emphasis is placed on creating a controlled and deterministic experiment which can be replicated and reproduced. Persistance of key data is prioritised to ensure that offline and after the fact training of the ML model can be completed. Furthermore, visual analysis can easily be generated and performed indepedently from data generation, allowing for further analysis whenever the study requires.

The simulation is designed in a way to mirror closely that of real-time physics simulations, especially the common traits of discretised timesteps, limited observability and high possibility of noise within the data due to computational gaps arising from discrete timesteps.

## Noise Model and Temporal Windowing

Central to the goal of measuring real-time discretised physics simulations was the use of temporal windowing of contact events, along with the inclusion of Gaussian noise within the data windows. Real-time simulations such as games and interactive physics applications rarely have perfect information, often relying on short historical state windows.

As such, to ensure relevance, a temporal window of position and velocity data is logged and persisted for each simulation run. Configurable noise is then added to data within the temporal window, as well as index jittering in order to elude greater correctional potential from the learned model.

This technique of using noisy, temporal data allows the model to adapt to noisy data and detect discontinuities and irregularities in the data, with the goal of becoming better at generalising to more complicated data sets.

## Baseline Estimators

## Machine Learning Model

## Training and Evaluation

## Results

## Discussion

## Next Steps

## How to Run
